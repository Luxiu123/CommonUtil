<Page x:Class="CommonUtil.View.RegexExtractionView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:CommonUtil.View" 
      xmlns:ui="http://schemas.modernwpf.com/2019"
      xmlns:widget="clr-namespace:CommonUtil.Widget"
      mc:Ignorable="d" 
      Margin="8"
      DataContext="{Binding RelativeSource={RelativeSource Mode=Self}}"
      d:DesignHeight="450" d:DesignWidth="800"
      Title="RegexExtractionView">

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition/>
      <RowDefinition Height="auto"/>
      <RowDefinition/>
    </Grid.RowDefinitions>
    <!-- 输入 -->
    <TextBox Text="{Binding InputText}" Style="{StaticResource MultilineTextBoxStyle}"/>
    <!-- control -->
    <Grid Grid.Row="1" Margin="0,8,0,8">
      <ui:SimpleStackPanel Orientation="Vertical"
                           HorizontalAlignment="Center">
        <ui:SimpleStackPanel.Resources>
          <Style TargetType="ui:SimpleStackPanel">
            <Setter Property="Orientation" Value="Horizontal"/>
            <Setter Property="Spacing" Value="8"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
          </Style>
        </ui:SimpleStackPanel.Resources>
        <ui:SimpleStackPanel>
          <StackPanel Orientation="Horizontal">
            <TextBlock Text="查找正则表达式"/>
            <TextBlock Text="&#xe650;"
                       Padding="4"
                       ToolTipService.InitialShowDelay="{StaticResource ToolTipServiceInitialShowDelay}"
                       MouseUp="MoreRegexMouseUp">
              <TextBlock.Resources>
                <Style TargetType="TextBlock" BasedOn="{StaticResource IconFontStyle}">
                  <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                      <Setter Property="Cursor" Value="Hand"/>
                      <Setter Property="Foreground" Value="{StaticResource ApplicationBackgroundDark2}"/>
                    </Trigger>
                  </Style.Triggers>
                </Style>
              </TextBlock.Resources>
              <TextBlock.ToolTip>
                <ToolTip Content="更多"/>
              </TextBlock.ToolTip>
            </TextBlock>
          </StackPanel>
          <TextBox MinWidth="150" 
                   Text="{Binding SearchRegex,UpdateSourceTrigger=PropertyChanged}"
                   KeyUp="SearchRegexComboBoxKeyUp"/>
          <CheckBox Content="忽略大小写" IsChecked="{Binding IgnoreCase}"/>
        </ui:SimpleStackPanel>
        <ui:SimpleStackPanel>
          <widget:IconButton Icon="&#xe612;" Text="查找" Click="SearchClick"/>
          <widget:IconButton Icon="&#xe6ef;" Text="复制结果" Click="CopyResultClick"/>
          <widget:IconButton Icon="&#xe946;" 
                             Text="清空输入"
                             Style="{StaticResource GlobalErrorButtonStyle}"
                             Click="ClearInputClick"/>
        </ui:SimpleStackPanel>
      </ui:SimpleStackPanel>
      <StackPanel x:Name="ResultDetailPanel"
                  Visibility="Collapsed"
                  HorizontalAlignment="Right"
                  VerticalAlignment="Bottom">
        <TextBlock>
          <TextBlock Text="{Binding MatchList.Count}"
                     Foreground="{DynamicResource ApplicationBackground}"
                     FontWeight="Bold"/>
          <TextBlock Text=" 个匹配结果"/>
        </TextBlock>
      </StackPanel>
    </Grid>
    <!-- 输出 -->
    <TextBox Grid.Row="2"
             Style="{StaticResource MultilineTextBoxStyle}"
             IsReadOnly="True"
             Text="{Binding OutputText}"/>
  </Grid>
</Page>
